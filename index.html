<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>道具管理システム</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
        form { margin-bottom: 20px; }
        label { display: block; margin-bottom: 10px; }
        button { padding: 8px 16px; background-color: #007BFF; color: #fff; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
    </style>
</head>
<body>
    <h1>道具管理システム</h1>

    <!-- フォーム: 新しい道具を追加 -->
    <h2>新しい道具を追加</h2>
    <form id="add-tool-form">
        <label>
            カテゴリ:
            <input type="text" id="category" required>
        </label>
        <label>
            道具名:
            <input type="text" id="name" required>
        </label>
        <label>
            在庫数:
            <input type="number" id="stock" required>
        </label>
        <button type="submit">追加</button>
    </form>

    <!-- テーブル: 道具リスト -->
    <h2>道具リスト</h2>
    <table id="tool-table">
        <thead>
            <tr>
                <th>カテゴリ</th>
                <th>道具名</th>
                <th>在庫数</th>
            </tr>
        </thead>
        <tbody>
            <!-- データが動的に挿入されます -->
        </tbody>
    </table>

    <!-- スクリプト -->
    <script>
        const scriptUrl = "https://script.google.com/macros/s/AKfycbwnThpT8CEMF0e7dz_tgyhGr1yNJaEoXP0OKFu0Ma3jeajNvyiFd4Rtp9tXtn5yVsiV/exec";

        // フォーム送信時に新しい道具を追加
        document.getElementById("add-tool-form").addEventListener("submit", function(e) {
            e.preventDefault(); // フォームのデフォルト動作を防止

            // 入力データを取得
            const category = document.getElementById("category").value;
            const name = document.getElementById("name").value;
            const stock = document.getElementById("stock").value;

            // Google Apps ScriptのURLにデータを送信
            fetch(scriptUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ category, name, stock })
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert("新しい道具が追加されました！");
                    // フォームをリセット
                    document.getElementById("add-tool-form").reset();
                    // 最新データを再取得してテーブルを更新
                    loadData();
                }
            })
            .catch(error => console.error("データ送信中にエラーが発生しました:", error));
        });

        // データを取得してテーブルを更新
        function loadData() {
            fetch(scriptUrl)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.querySelector("#tool-table tbody");
                    tableBody.innerHTML = ""; // テーブルをクリア
                    data.forEach(tool => {
                        const row = document.createElement("tr");
                        row.innerHTML = `<td>${tool.category}</td><td>${tool.name}</td><td>${tool.stock}</td>`;
                        tableBody.appendChild(row);
                    });
                })
                .catch(error => console.error("データの読み込み中にエラーが発生しました:", error));
        }

        // ページ読み込み時にデータをロード
        loadData();
    </script>
</body>
</html>
